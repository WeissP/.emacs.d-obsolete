(package-initialize)
(setq package-archives
      '(("gnu"   . "http://elpa.gnu.org/packages/")
        ("melpa" . "http://melpa.org/packages/")))

(unless (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))

(setq package-selected-packages
      '(use-package quelpa-use-package))

(setq use-package-ensure-function 'quelpa)
(setq quelpa-checkout-melpa-p nil)
(setq quelpa-update-melpa-p nil)
(setq use-package-always-demand t)
(setq use-package-always-ensure t)
(require 'use-package)
(require 'quelpa-use-package)
(quelpa-use-package-activate-advice)

;; Required by `use-package'
(use-package diminish)
(use-package bind-key)

(use-package which-key 
  :diminish
  :hook (after-init . which-key-mode)
  )

(use-package ryo-modal
  :commands ryo-modal-mode
  :bind ("M-m" . ryo-modal-mode)
  :init
  (add-hook 'ryo-modal-mode-hook
            (lambda ()
              (if ryo-modal-mode
                  (selected-minor-mode 1)
                (selected-minor-mode -1))))
  :config
  (push '((nil . "ryo:.*:") . (nil . "")) which-key-replacement-alist)
  (ryo-modal-keys
   ("j"  next-line)
   )
  ) 

  (use-package selected
    :commands selected-minor-mode
    :bind (:map selected-keymap
                ("o" . previous-line)
                )
    :init
    (setq selected-minor-mode-override t)
    )
